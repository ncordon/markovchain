<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>GSoC-2017_Additions • markovchain</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha256-916EbMg70RQy9LHiGkXzG8hSg9EdNy97GazNG/aiY1w=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha256-U5ZEeKfGNOja007MMD3YBI0A3OSZOQbeG6z2f2Y0hu8=" crossorigin="anonymous"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css" integrity="sha256-eZrrJcwDc/3uDhsdt61sL2oOBY362qM3lon1gyExkL0=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" integrity="sha256-FiZwavyI2V6+EXO1U+xzLG3IKldpiTFf3153ea9zikQ=" crossorigin="anonymous"></script><!-- sticky kit --><script src="https://cdnjs.cloudflare.com/ajax/libs/sticky-kit/1.1.3/sticky-kit.min.js" integrity="sha256-c4Rlo1ZozqTPE2RLuvbusY3+SU1pQaJC0TjuhygMipw=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="GSoC-2017_Additions">
<meta property="og:description" content="">
<meta name="twitter:card" content="summary">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">markovchain</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.6.9.14</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fa fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/GSoC-2017_additions.html">GSoC-2017_Additions</a>
    </li>
    <li>
      <a href="../articles/an_introduction_to_markovchain_package.pdf">The markovchain Package: A Package for Easily Handling Discrete Markov Chains in R (PDF)</a>
    </li>
    <li>
      <a href="../articles/complicateSteadyStates.html">Complicate Steady States Analysis</a>
    </li>
    <li>
      <a href="../articles/higher_order_markov_chains.pdf">Higher, possibly multivariate, Order Markov Chains in markovchain package (PDF)</a>
    </li>
    <li>
      <a href="../articles/markovchainCrashIntro.pdf">Crash Introduction to markovchain R package (PDF)</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/spedygiorgio/markovchain">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      
      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1>GSoC-2017_Additions</h1>
                        <h4 class="author">Vandit Jain</h4>
            
            <h4 class="date">August 2017</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/spedygiorgio/markovchain/blob/master/vignettes/GSoC-2017_additions.Rmd"><code>vignettes/GSoC-2017_additions.Rmd</code></a></small>
      <div class="hidden name"><code>GSoC-2017_additions.Rmd</code></div>

    </div>

    
    
<div id="expected-hittting-time-using-ctmc" class="section level1">
<h1 class="hasAnchor">
<a href="#expected-hittting-time-using-ctmc" class="anchor"></a>Expected Hittting Time using CTMC</h1>
<p>The package provides <code>ExpectedTime</code> function to calculate average hitting time from one state to another. Let the final state be j, then for every state <span class="math inline">\(i \in I\)</span>, where <span class="math inline">\(I\)</span> is the set of all possible states and holding time <span class="math inline">\(q_{i} &gt; 0\)</span> for every <span class="math inline">\(i \neq j\)</span>. Assuming the conditions to be true, expected hitting time is equal to minimal non-negative solution vector <span class="math inline">\(p\)</span> to the system of linear equations<span class="citation">(Norris 1998)</span>: <span class="math display">\[\begin{equation}
\begin{cases}
      p_{k} = 0 &amp; k = j \\
      -\sum_{l \in I} q_{kl}p_{k} = 1 &amp; k \neq j
\end{cases}
\label{eq:EHT}
\end{equation}\]</span></p>
<p>For example, consider the continuous time markovchain which is as follows:</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1-1" data-line-number="1"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/library">library</a></span>(markovchain)</a>
<a class="sourceLine" id="cb1-2" data-line-number="2">states &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="st">"a"</span>,<span class="st">"b"</span>,<span class="st">"c"</span>,<span class="st">"d"</span>)</a>
<a class="sourceLine" id="cb1-3" data-line-number="3">byRow &lt;-<span class="st"> </span><span class="ot">TRUE</span></a>
<a class="sourceLine" id="cb1-4" data-line-number="4">gen &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/matrix">matrix</a></span>(<span class="dt">data =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="op">-</span><span class="dv">1</span>, <span class="dv">1</span><span class="op">/</span><span class="dv">2</span>, <span class="dv">1</span><span class="op">/</span><span class="dv">2</span>, <span class="dv">0</span>, <span class="dv">1</span><span class="op">/</span><span class="dv">4</span>, <span class="dv">-1</span><span class="op">/</span><span class="dv">2</span>, <span class="dv">0</span>, <span class="dv">1</span><span class="op">/</span><span class="dv">4</span>, <span class="dv">1</span><span class="op">/</span><span class="dv">6</span>, <span class="dv">0</span>, <span class="dv">-1</span><span class="op">/</span><span class="dv">3</span>, <span class="dv">1</span><span class="op">/</span><span class="dv">6</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>),</a>
<a class="sourceLine" id="cb1-5" data-line-number="5"><span class="dt">nrow =</span> <span class="dv">4</span>,<span class="dt">byrow =</span> byRow, <span class="dt">dimnames =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/list">list</a></span>(states,states))</a>
<a class="sourceLine" id="cb1-6" data-line-number="6">ctmc &lt;-<span class="st"> </span><span class="kw">new</span>(<span class="st">"ctmc"</span>,<span class="dt">states =</span> states, <span class="dt">byrow =</span> byRow, <span class="dt">generator =</span> gen, <span class="dt">name =</span> <span class="st">"testctmc"</span>)</a></code></pre></div>
<p>The generator matrix of the ctmc is: <span class="math display">\[
M = \left(\begin{matrix}
-1 &amp; 1/2 &amp; 1/2 &amp; 0\\
1/4 &amp; -1/2 &amp; 1/4 &amp; 1/6\\
1/6 &amp; 0 &amp; -1/3 &amp; 1/6\\
0 &amp; 0 &amp; 0 &amp; 0\\
\end{matrix}\right)
\]</span></p>
<p>Now if we have to calculate expected hitting time the process will take to hit state <span class="math inline">\(d\)</span> if we start from <span class="math inline">\(a\)</span>, we apply the <span class="math inline">\(ExpectedTime\)</span> function. <span class="math inline">\(ExpectedTime\)</span> function takes four inputs namely a <span class="math inline">\(ctmc\)</span> class object, initial state <span class="math inline">\(i\)</span>, the final state <span class="math inline">\(j\)</span> that we have to calculate expected hitting time and a logical parameter whether to use RCpp implementation. By default, the function uses RCpp as it is faster and takes lesser time.</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb2-1" data-line-number="1"><span class="kw"><a href="../reference/ExpectedTime.html">ExpectedTime</a></span>(ctmc,<span class="dv">1</span>,<span class="dv">4</span>)</a></code></pre></div>
<pre><code>## [1] 7</code></pre>
<p>We find that the expected hitting time for process to be hit state <span class="math inline">\(d\)</span> is 7 units in this case.</p>
</div>
<div id="calculating-probability-at-time-t-using-ctmc" class="section level1">
<h1 class="hasAnchor">
<a href="#calculating-probability-at-time-t-using-ctmc" class="anchor"></a>Calculating Probability at time T using ctmc</h1>
<p>The package provides a function <code>probabilityatT</code> to calculate probability of every state according to given <code>ctmc</code> object. The Kolmogorov’s backward equation gives us a relation between transition matrix at any time t with the geneartor matrix<span class="citation">(Dobrow 2016)</span>:</p>

<p>Here we use the solution of this differential equation <span class="math inline">\(P(t) = P(0)e^{tQ}\)</span> for <span class="math inline">\(t \geq 0\)</span> and <span class="math inline">\(P(0) = I\)</span>. In this equation, <span class="math inline">\(P(t)\)</span> is the transition function at time t. The value <span class="math inline">\(P(t)[i][j]\)</span> at time <span class="math inline">\(P(t)\)</span> describes the conditional probability of the state at time <span class="math inline">\(t\)</span> to be equal to j if it was equal to i at time <span class="math inline">\(t=0\)</span>. It takes care of the case when <code>ctmc</code> object has a generator represented by columns. If inital state is not provided, the function returns the whole transition matrix <span class="math inline">\(P(t)\)</span>.</p>
<p>Also to mention is that the function is also implemented using RCpp and can be used used to lessen the time of computation. It is used by default. Next, We consider both examples where intial state is given and case where initial state is not given.</p>
<p>In the first case, the function takes two inputs, first of them is an object of the S4 class ‘ctmc’ and second is the final time <span class="math inline">\(t\)</span>.</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb4-1" data-line-number="1"><span class="kw"><a href="../reference/probabilityatT.html">probabilityatT</a></span>(ctmc,<span class="dv">1</span>)</a></code></pre></div>
<pre><code>##            a          b         c          d
## a 0.41546882 0.24714119 0.2703605 0.06702946
## b 0.12357060 0.63939068 0.0348290 0.20220972
## c 0.09012017 0.02321933 0.7411205 0.14553997
## d 0.00000000 0.00000000 0.0000000 1.00000000</code></pre>
<p>Here we get an output in the form of a transition matrix.</p>
<p>If we take the second case i.e. considering some initial input:</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb6-1" data-line-number="1"><span class="kw"><a href="../reference/probabilityatT.html">probabilityatT</a></span>(ctmc,<span class="dv">1</span>,<span class="dv">1</span>)</a></code></pre></div>
<pre><code>## [1] 0.41546882 0.24714119 0.27036052 0.06702946</code></pre>
<p>In this case we get the probabilities corresponding to every state. this also includes probability that the process hits the same state <span class="math inline">\(a\)</span> after time <span class="math inline">\(t=1\)</span>.</p>
</div>
<div id="plotting-generator-matrix-of-continuous-time-markovchains" class="section level1">
<h1 class="hasAnchor">
<a href="#plotting-generator-matrix-of-continuous-time-markovchains" class="anchor"></a>Plotting generator matrix of continuous-time markovchains</h1>
<p>The package provides a <code>plot</code> function for plotting a generator matrix <span class="math inline">\(Q\)</span> in the form of a directed graph where every possible state is assigned a node. Edges connecting these nodes are weighted. Weight of the edge going from a state <span class="math inline">\(i\)</span> to state <span class="math inline">\(j\)</span> is equal to the value <span class="math inline">\(Q_{ij}\)</span>. This gives a picture of the generator matrix.</p>
<p>For example, we build a ctmc-class object to plot it.</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb8-1" data-line-number="1">energyStates &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="st">"sigma"</span>, <span class="st">"sigma_star"</span>)</a>
<a class="sourceLine" id="cb8-2" data-line-number="2">byRow &lt;-<span class="st"> </span><span class="ot">TRUE</span></a>
<a class="sourceLine" id="cb8-3" data-line-number="3">gen &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/matrix">matrix</a></span>(<span class="dt">data =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="op">-</span><span class="dv">3</span>, <span class="dv">3</span>,</a>
<a class="sourceLine" id="cb8-4" data-line-number="4">                       <span class="dv">1</span>, <span class="dv">-1</span>), <span class="dt">nrow =</span> <span class="dv">2</span>,</a>
<a class="sourceLine" id="cb8-5" data-line-number="5">              <span class="dt">byrow =</span> byRow, <span class="dt">dimnames =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/list">list</a></span>(energyStates, energyStates))</a>
<a class="sourceLine" id="cb8-6" data-line-number="6">molecularCTMC &lt;-<span class="st"> </span><span class="kw">new</span>(<span class="st">"ctmc"</span>, <span class="dt">states =</span> energyStates, </a>
<a class="sourceLine" id="cb8-7" data-line-number="7">                 <span class="dt">byrow =</span> byRow, <span class="dt">generator =</span> gen, </a>
<a class="sourceLine" id="cb8-8" data-line-number="8">                 <span class="dt">name =</span> <span class="st">"Molecular Transition Model"</span>)    </a></code></pre></div>
<p>Now if we plot this function we get the following graph:</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb9-1" data-line-number="1"><span class="kw"><a href="https://www.rdocumentation.org/packages/graphics/topics/plot">plot</a></span>(molecularCTMC)</a></code></pre></div>
<p><img src="GSoC-2017_additions_files/figure-html/unnamed-chunk-6-1.png" width="700"></p>
<p>The figure shown is built using the <span class="math inline">\(igraph\)</span> package. The package also provides options of plotting graph using <span class="math inline">\(diagram\)</span> and <span class="math inline">\(DiagrameR\)</span> package. Plot using these packages can be built using these commands:</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb10-1" data-line-number="1"><span class="kw"><a href="https://www.rdocumentation.org/packages/graphics/topics/plot">plot</a></span>(molecularCTMC,<span class="dt">package =</span> <span class="st">"diagram"</span>)</a></code></pre></div>
<p><img src="GSoC-2017_additions_files/figure-html/unnamed-chunk-7-1.png" width="700"></p>
<p>Similarly, one can easily replace <span class="math inline">\(diagram\)</span> package with <span class="math inline">\(DiagrammeR\)</span></p>
</div>
<div id="imprecise-conitnuous-time-markovchains" class="section level1">
<h1 class="hasAnchor">
<a href="#imprecise-conitnuous-time-markovchains" class="anchor"></a>Imprecise Conitnuous-Time Markovchains</h1>
<p>Continuous-time Markov chains are mathematical models that are used to describe the state-evolution of dynamical systems under stochastic uncertainty. However, building models usign continuous time markovchains tkae in consideration a number of assumptions which may not be realistic for the domain of application; in particular; the ability to provide exact numerical parameter assessments, and the applicability of time-homogeneity and the eponymous Markov property. Hence we take ICTMC into consideration.</p>
<p>More technically, an ICTMC is a set of “precise” continuous-time finite-state stochastic processes, and rather than computing expected values of functions, we seek to compute lower expectations, which are tight lower bounds on the expectations that correspond to such a set of “precise” models.</p>
<div id="types-of-ictmcs" class="section level2">
<h2 class="hasAnchor">
<a href="#types-of-ictmcs" class="anchor"></a>Types of ICTMCs</h2>
<p>For any non-empty bounded set of rate matrices <span class="math inline">\(L\)</span>, and any non-empty set <span class="math inline">\(M\)</span> of probability mass functions on <span class="math inline">\(X\)</span>, we define the following three sets of stochastic processes that are jointly consistent with <span class="math inline">\(L\)</span> and <span class="math inline">\(M\)</span>:</p>
<ul>
<li>
<span class="math inline">\(P^{W}_{L,M}\)</span> is the consistent set of all well-behaved stochastic processes;</li>
<li>
<span class="math inline">\(P^{WM}_{L,M}\)</span> is the consistent set of all well-behaved Markov chains;</li>
<li>
<span class="math inline">\(P^{WHM}_{L,M}\)</span> is the consistent set of all well-behaved homogeneous Markov chains<span class="citation">(Thomas Krak 2016)</span>.</li>
</ul>
<p>From a practical point of view, after having specified a (precise) stochastic process, one is typically interested in the expected value of some function of interest, or the probability of some event. Similarly, in this work, our main objects of consideration will be the lower probabilities that correspond to the ICTMCs.</p>
</div>
<div id="lower-transition-rate-operators-for-ictmcs" class="section level2">
<h2 class="hasAnchor">
<a href="#lower-transition-rate-operators-for-ictmcs" class="anchor"></a>Lower Transition Rate Operators for ICTMCs</h2>
<p>A map <span class="math inline">\(Q_{l}\)</span> from <span class="math inline">\(L(X)\)</span> to <span class="math inline">\(L(X)\)</span> is called a lower transition rate operator if, for all <span class="math inline">\(f,g \in L(X)\)</span>, all <span class="math inline">\(\lambda \in R_{\geq 0}\)</span>, all <span class="math inline">\(\mu \in L(X)\)</span>, and all <span class="math inline">\(x \in X\)</span><span class="citation">(Thomas Krak 2016)</span>:</p>
<ol style="list-style-type: decimal">
<li><span class="math inline">\([Q_{l}m](x) = 0\)</span></li>
<li>
<span class="math inline">\([Q_{l}I](x) \geq 0 \forall y \in X\)</span> such that <span class="math inline">\(x \neq y\)</span>
</li>
<li><span class="math inline">\([Q_{l}(f + g)](x)\geq [Q_{l}f](x) + [Q_{l}g](x)\)</span></li>
<li><span class="math inline">\([Q_{l}(l f)](x) = \lambda Q_{l}f[(x)]\)</span></li>
</ol>
</div>
<div id="lower-transition-operators" class="section level2">
<h2 class="hasAnchor">
<a href="#lower-transition-operators" class="anchor"></a>Lower Transition Operators</h2>
<p>A map <span class="math inline">\(T_{l}\)</span> from <span class="math inline">\(L (X )\)</span> to <span class="math inline">\(L (X )\)</span> is called a lower transition operator if, for all <span class="math inline">\(f,g \in L(X)\)</span>, all <span class="math inline">\(\lambda \in R_{\geq 0}\)</span>, all <span class="math inline">\(\mu \in L(X)\)</span>, and all <span class="math inline">\(x \in X\)</span><span class="citation">(Thomas Krak 2016)</span>:</p>
<ol style="list-style-type: decimal">
<li><span class="math inline">\([T_{l} f](x) \geq min(f(y) : y \in L)\)</span></li>
<li><span class="math inline">\([T_{l}(f +g)](x) \geq [T_{l} f](x)+[T_{l}g](x)\)</span></li>
<li><span class="math inline">\([T_{l}(\lambda f)](x) = l [T_{l} f](x)\)</span></li>
</ol>
</div>
<div id="impreciseprobabilityatt-function" class="section level2">
<h2 class="hasAnchor">
<a href="#impreciseprobabilityatt-function" class="anchor"></a><code>ImpreciseprobabilityatT</code> function</h2>
<p>Now I would like to come onto the practical purpose of using ICTMC classes. ICTMC classes in these package are defined to represent a generator that is defined in such a way that every row of the generator corresponding to every state in the process is governed by a separate variable. As defined earlier, an imprecise continuous time markovchain is a set of many precise CTMCs. Hence this representation of set of precise CTMCs can be used to calulate transition probability at some time in future. This can be seen as an analogy with <code>probabilityatT</code> function. It is used to calculate the transition function at some later time t using generatoe matrix.</p>
<p>For every generator matrix, we have a corresponding transition function. Similarly, for every Lower Transition rate operator of an ICTMC, we have a corresponding lower transition operator denoted by <span class="math inline">\(L_{t}^{s}\)</span>. Here <span class="math inline">\(t\)</span> is the initial time and <span class="math inline">\(s\)</span> is the final time.</p>
<p>Now we mention a proposition<span class="citation">(Thomas Krak 2016)</span> which states that: Let <span class="math inline">\(Q_{l}\)</span> be a lower transition rate operator, choose any time <span class="math inline">\(t\)</span> and <span class="math inline">\(s\)</span> both greater than 0 such that <span class="math inline">\(t \leq s\)</span>, and let <span class="math inline">\(L_{t}^{s}\)</span> be the lower transition operator corresponding to <span class="math inline">\(Q_{l}\)</span>. Then for any <span class="math inline">\(f \in L(X)\)</span> and <span class="math inline">\(\epsilon \in R_{&gt;0}\)</span>, if we choose any <span class="math inline">\(n \in N\)</span> such that:</p>
<p><span class="math display">\[n \geq max((s-t)*||Q||,\frac{1}{2\epsilon}(s-t)^{2}||Q||^{2}||f||_v)\]</span></p>
<p>with <span class="math inline">\(||f||_{v}\)</span> := max <span class="math inline">\(f\)</span> - min <span class="math inline">\(f\)</span>, we are guaranteed that<span class="citation">(Thomas Krak 2016)</span></p>
<p><span class="math display">\[ ||L_{t}^{s} - \prod_{i=1}^{n}(I + \Delta Q_{l}) || \leq \epsilon\]</span></p>
<p>with <span class="math inline">\(\Delta := \frac{s-t}{n}\)</span></p>
<p>Simple put this equation tells us that, using <span class="math inline">\(Q_{l}g\)</span> for all <span class="math inline">\(g \in L(X)\)</span> then we can also approximate the quantity <span class="math inline">\(L_{t}^{s}\)</span> to arbitrary precision, for any given <span class="math inline">\(f \in L(X)\)</span>.</p>
<p>To explain this approximate calculation, I would take a detailed example of a process containing two states healthy and sick, hence <span class="math inline">\(X = (healthy,sick)\)</span>. If we represent in form of an ICTMC, we get:</p>
<p><span class="math display">\[
Q = \left(\begin{matrix}
-a &amp; a \\
b &amp; -b
\end{matrix}\right)
\]</span> for some <span class="math inline">\(a,b \in R_{\geq 0}\)</span>. The parameter <span class="math inline">\(a\)</span> here is the rate at which a healthy person becomes sick. Technically, this means that if a person is healthy at time <span class="math inline">\(t\)</span>, the probability that he or she will be sick at time <span class="math inline">\(t +\Delta\)</span>, for small <span class="math inline">\(\Delta\)</span>, is very close to <span class="math inline">\(\Delta a\)</span>. More intuitively, if we take the time unit to be one week, it means that he or she will, on average, become sick after <span class="math inline">\(\frac{1}{a}\)</span> weeks. The parameter <span class="math inline">\(b\)</span> is the rate at which a sick person becomes healthy again, and has a similar interpretation.</p>
<p>Now to completely represent the ICTMC we take an example and write the generator as:</p>
<p><span class="math display">\[
Q = \left(\begin{matrix}
-a &amp; a \\
b &amp; -b
\end{matrix}\right)
: a \in [\frac{1}{52},\frac{3}{52}],b \in [\frac{1}{2},2]
\]</span></p>
<p>Now suppose we know the initial state of the patient to be sick, hence this is reprsented in the form of a function by: <span class="math display">\[
I_{s} = \left(\begin{matrix}
0 \\
1 
\end{matrix}\right)
\]</span> We observe that the <span class="math inline">\(||I_{s}|| = 1\)</span>. Now to use the proposition mentioned above, we use the definition to calculate the lower transition operator <span class="math inline">\(Q_{l}\)</span> Next we calculate the norm of the lower transition rate operator and use it in the preposition. Also we take value of <span class="math inline">\(\epsilon\)</span> to be 0.001.</p>
<p>Using the preposition we can come upto an algorithm for calculating the probability at any time <span class="math inline">\(s\)</span> given state at initial time <span class="math inline">\(t\)</span> and a ICTMC generator<span class="citation">(Thomas Krak 2016)</span>.</p>
<p>The algorithm is as follows:</p>
<p><strong>Input</strong>: A lower transition rate operator <span class="math inline">\(Q\)</span>, two time points <span class="math inline">\(t,s\)</span> such that <span class="math inline">\(t \leq s\)</span>, a function <span class="math inline">\(f \in L(X )\)</span> and a maximum numerical error <span class="math inline">\(\epsilon \in R_{&gt;0}\)</span>.</p>
<p><strong>Algorithm</strong>:</p>
<ol style="list-style-type: decimal">
<li><span class="math inline">\(n = max((s-t)||Q||,\frac{1}{2\epsilon}(s-t)^{2}||Q||^{2}||f||_v)\)</span></li>
<li><span class="math inline">\(\Delta = \frac{s-t}{n}\)</span></li>
<li><span class="math inline">\(g_{0} = I_{s}\)</span></li>
<li>for <span class="math inline">\(i \in (1,.....,n)\)</span> do <span class="math inline">\(g_{i} = g_{i-1} + \Delta Q_{l}g_{i-1}\)</span>
</li>
<li>end for</li>
<li>return <span class="math inline">\(g_{n}\)</span>
</li>
</ol>
<p><strong>Output</strong>:</p>
<p>The conditional probability vector after time <span class="math inline">\(t\)</span> with error <span class="math inline">\(\epsilon\)</span>. Hence, after applying the algorithm on above example we get the following result:</p>
<p>$ g_{n} = 0.0083$ if final state is <span class="math inline">\(healthy\)</span> and <span class="math inline">\(g_{n} = 0.141\)</span> if the final state is <span class="math inline">\(sick\)</span>. The probability calculated is with an error equal to <span class="math inline">\(\epsilon\)</span> i.e. <span class="math inline">\(0.001\)</span>.</p>
<p>Now we run the algorithm on the example through R code.</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb11-1" data-line-number="1">states &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="st">"n"</span>,<span class="st">"y"</span>)</a>
<a class="sourceLine" id="cb11-2" data-line-number="2">Q &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/matrix">matrix</a></span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="op">-</span><span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="op">-</span><span class="dv">1</span>),<span class="dt">nrow =</span> <span class="dv">2</span>,<span class="dt">byrow =</span> <span class="ot">TRUE</span>,<span class="dt">dimnames =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/list">list</a></span>(states,states))</a>
<a class="sourceLine" id="cb11-3" data-line-number="3">range &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/matrix">matrix</a></span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="dv">1</span><span class="op">/</span><span class="dv">52</span>,<span class="dv">3</span><span class="op">/</span><span class="dv">52</span>,<span class="dv">1</span><span class="op">/</span><span class="dv">2</span>,<span class="dv">2</span>),<span class="dt">nrow =</span> <span class="dv">2</span>,<span class="dt">byrow =</span> <span class="dv">2</span>)</a>
<a class="sourceLine" id="cb11-4" data-line-number="4">name &lt;-<span class="st"> "testictmc"</span></a>
<a class="sourceLine" id="cb11-5" data-line-number="5">ictmc &lt;-<span class="st"> </span><span class="kw">new</span>(<span class="st">"ictmc"</span>,<span class="dt">states =</span> states,<span class="dt">Q =</span> Q,<span class="dt">range =</span> range,<span class="dt">name =</span> name)</a>
<a class="sourceLine" id="cb11-6" data-line-number="6"><span class="kw"><a href="../reference/impreciseProbabilityatT.html">impreciseProbabilityatT</a></span>(ictmc,<span class="dv">2</span>,<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">10</span><span class="op">^-</span><span class="dv">3</span>,<span class="ot">TRUE</span>)</a></code></pre></div>
<pre><code>## [1] 0.008259774 0.140983476</code></pre>
<p>The probabilites we get are with an error of <span class="math inline">\(10^{-3}\)</span></p>
</div>
</div>
<div id="continuous-time-markovchain-generator-using-frequency-matrix" class="section level1">
<h1 class="hasAnchor">
<a href="#continuous-time-markovchain-generator-using-frequency-matrix" class="anchor"></a>Continuous time markovchain generator using frequency Matrix</h1>
<p>The package provides <code>freq2Generator</code> function. It takes in a matrix representing relative frequency values along with time taken to provide a continuous time markovchain generator matrix. Here, frequency matrix is a 2-D matrix of dimensions equal to relative number of possible states describing the number of transitions from a state <span class="math inline">\(i\)</span> to <span class="math inline">\(j\)</span> in time <span class="math inline">\(t\)</span>, which is another parameter to be provided to the function. The function also allows to chose among three methods for calculation of the generator matrix.<span class="citation">(Alexander Kreinin 2001)</span></p>
<p>Three methods are as follows:</p>
<ol style="list-style-type: decimal">
<li>Quasi Optimisation - “QO”</li>
<li>Diagonal Adjustment - “DA”</li>
<li>Weighted Adjustment - “WA”</li>
</ol>
<p>See reference for details about the methods.</p>
<p>Here is an example matrix on which <code>freq2Generator</code> function is run:</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb13-1" data-line-number="1">sample &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/matrix">matrix</a></span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="dv">150</span>,<span class="dv">2</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">200</span>,<span class="dv">2</span>,<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">1</span>,<span class="dv">175</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">150</span>),<span class="dt">nrow =</span> <span class="dv">4</span>,<span class="dt">byrow =</span> <span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb13-2" data-line-number="2">sample_rel =<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/cbind">rbind</a></span>((sample<span class="op">/</span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/colSums">rowSums</a></span>(sample))[<span class="dv">1</span><span class="op">:</span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/dim">dim</a></span>(sample)[<span class="dv">1</span>]<span class="op">-</span><span class="dv">1</span>,],<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/rep">rep</a></span>(<span class="dv">0</span>,<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/dim">dim</a></span>(sample)[<span class="dv">1</span>]<span class="op">-</span><span class="dv">1</span>),<span class="dv">1</span>)) </a>
<a class="sourceLine" id="cb13-3" data-line-number="3"><span class="kw"><a href="../reference/freq2Generator.html">freq2Generator</a></span>(sample_rel,<span class="dv">1</span>)</a></code></pre></div>
<pre><code>##              [,1]        [,2]         [,3] [,4]
## [1,] -0.024212164  0.01544797  0.008764198    0
## [2,]  0.006594821 -0.01822834  0.011633520    0
## [3,]  0.013302567  0.00749703 -0.020799597    0
## [4,]  0.000000000  0.00000000  0.000000000    0</code></pre>
</div>
<div id="committor-of-a-markovchain" class="section level1">
<h1 class="hasAnchor">
<a href="#committor-of-a-markovchain" class="anchor"></a>Committor of a markovchain</h1>
<p>Consider set of states A,B comprising of states from a markovchain with transition matrix P. The committor vector of a markovchain with respect to sets A and B gives the probability that the process will hit a state from set A before any state from set B.</p>
<p>Committor vector u can be calculated by solving the following system of linear equations<span class="citation">(StackOverflow 2015)</span>:</p>
<p><span class="math display">\[
  \begin{array}{l}
  Lu(x) = 0,  x \notin A \cup B \\
  u(x) = 1,   x \in A \\
  u(x) = 0,   x \in B
  \end{array}
\]</span> where <span class="math inline">\(L = P -I\)</span>.</p>
<p>Now we apply the method to an example:</p>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb15-1" data-line-number="1">transMatr &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/matrix">matrix</a></span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">1</span>,<span class="fl">0.5</span>,<span class="fl">0.5</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="fl">0.5</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="fl">0.2</span>,<span class="fl">0.4</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="fl">0.8</span>,<span class="fl">0.6</span>,<span class="dv">0</span>,<span class="fl">0.5</span>),<span class="dt">nrow =</span> <span class="dv">5</span>)</a>
<a class="sourceLine" id="cb15-2" data-line-number="2">object &lt;-<span class="st"> </span><span class="kw">new</span>(<span class="st">"markovchain"</span>, <span class="dt">states=</span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="st">"a"</span>,<span class="st">"b"</span>,<span class="st">"c"</span>,<span class="st">"d"</span>,<span class="st">"e"</span>),<span class="dt">transitionMatrix=</span>transMatr, <span class="dt">name=</span><span class="st">"simpleMc"</span>)</a>
<a class="sourceLine" id="cb15-3" data-line-number="3"><span class="kw"><a href="../reference/committorAB.html">committorAB</a></span>(object,<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="dv">5</span>),<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="dv">3</span>))</a></code></pre></div>
<pre><code>##         a         b         c         d         e 
## 0.4444444 0.8888889 0.0000000 0.4444444 1.0000000</code></pre>
<p>Here we get probability that the process will hit state “e” before state “c” given different initial states.</p>
</div>
<div id="first-passage-probability-for-set-of-states" class="section level1">
<h1 class="hasAnchor">
<a href="#first-passage-probability-for-set-of-states" class="anchor"></a>First Passage probability for set of States</h1>
<p>Currently computation of the first passage time for individual states has been implemented in the package. <code>firstPassageMultiple</code> function provides a method to get first passage probability for given provided set of states.</p>
<p>Consider this example markovchain object:</p>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb17-1" data-line-number="1">statesNames &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="st">"a"</span>, <span class="st">"b"</span>, <span class="st">"c"</span>)</a>
<a class="sourceLine" id="cb17-2" data-line-number="2">testmarkov &lt;-<span class="st"> </span><span class="kw">new</span>(<span class="st">"markovchain"</span>, <span class="dt">states =</span> statesNames, <span class="dt">transitionMatrix =</span></a>
<a class="sourceLine" id="cb17-3" data-line-number="3"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/matrix">matrix</a></span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="fl">0.2</span>, <span class="fl">0.5</span>, <span class="fl">0.3</span>,</a>
<a class="sourceLine" id="cb17-4" data-line-number="4"><span class="fl">0.5</span>, <span class="fl">0.1</span>, <span class="fl">0.4</span>,</a>
<a class="sourceLine" id="cb17-5" data-line-number="5"><span class="fl">0.1</span>, <span class="fl">0.8</span>, <span class="fl">0.1</span>), <span class="dt">nrow =</span> <span class="dv">3</span>, <span class="dt">byrow =</span> <span class="ot">TRUE</span>,</a>
<a class="sourceLine" id="cb17-6" data-line-number="6"><span class="dt">dimnames =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/list">list</a></span>(statesNames, statesNames)</a>
<a class="sourceLine" id="cb17-7" data-line-number="7">))</a></code></pre></div>
<p>Now we apply <code>firstPassageMultiple</code> function to calculate first passage probabilities for set of states <span class="math inline">\("b", "c"\)</span> when intial state is <span class="math inline">\("a"\)</span>.</p>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb18-1" data-line-number="1"><span class="kw"><a href="../reference/firstPassageMultiple.html">firstPassageMultiple</a></span>(testmarkov,<span class="st">"a"</span>,<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="st">"b"</span>,<span class="st">"c"</span>),<span class="dv">4</span>)</a></code></pre></div>
<pre><code>##      set
## 1 0.8000
## 2 0.6000
## 3 0.2540
## 4 0.1394</code></pre>
<p>This shows us the probability that the process will hit any of the state from the set after n number of steps for instance, as shown, the probability of the process to hit any of the states among <span class="math inline">\("b", "c"\)</span> after <span class="math inline">\(2\)</span> steps is <span class="math inline">\(0.6000\)</span>.</p>
</div>
<div id="joint-pdf-of-number-of-visits-to-the-various-states-of-a-markovchain" class="section level1">
<h1 class="hasAnchor">
<a href="#joint-pdf-of-number-of-visits-to-the-various-states-of-a-markovchain" class="anchor"></a>Joint PDF of number of visits to the various states of a markovchain</h1>
<p>The package provides a function <code>noofVisitsDist</code> that returns the PDF of the number of visits to the various states of the discrete time markovchain during the first N steps, given intial state of the process.</p>
<p>We will take an example to see how to use the function on a <code>markovchain-class</code> object:</p>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb20-1" data-line-number="1">transMatr&lt;-<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/matrix">matrix</a></span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="fl">0.4</span>,<span class="fl">0.6</span>,.<span class="dv">3</span>,.<span class="dv">7</span>),<span class="dt">nrow=</span><span class="dv">2</span>,<span class="dt">byrow=</span><span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb20-2" data-line-number="2">simpleMc&lt;-<span class="kw">new</span>(<span class="st">"markovchain"</span>, <span class="dt">states=</span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="st">"a"</span>,<span class="st">"b"</span>),</a>
<a class="sourceLine" id="cb20-3" data-line-number="3">              <span class="dt">transitionMatrix=</span>transMatr, </a>
<a class="sourceLine" id="cb20-4" data-line-number="4">              <span class="dt">name=</span><span class="st">"simpleMc"</span>)   </a>
<a class="sourceLine" id="cb20-5" data-line-number="5"><span class="kw"><a href="../reference/noofVisitsDist.html">noofVisitsDist</a></span>(simpleMc,<span class="dv">5</span>,<span class="st">"a"</span>)</a></code></pre></div>
<pre><code>##        a        b 
## 0.348148 0.651852</code></pre>
<p>The output clearly shows the probabilities related to various states of the process.</p>
</div>
<div id="expected-rewards-for-a-markovchain" class="section level1">
<h1 class="hasAnchor">
<a href="#expected-rewards-for-a-markovchain" class="anchor"></a>Expected Rewards for a markovchain</h1>
<p>The package provides a function <code>expectedRewards</code> that returns a vector of expected rewards for different initial states. The user provides reward values, a vector <span class="math inline">\(r\)</span> of size equal to number of states having a value corresponding to every state. Given a transition matrix <span class="math inline">\([P]\)</span>, we get the vector of expected rewards <span class="math inline">\(v\)</span> after <span class="math inline">\(n\)</span> transitions according to the equation as follows<span class="citation">(Gallager 2013)</span>:</p>
<p><span class="math inline">\(v[n] = r + [P]*v[n-1]\)</span></p>
<p>Applying this equation on a markovchain-class object</p>
<div class="sourceCode" id="cb22"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb22-1" data-line-number="1">transMatr&lt;-<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/matrix">matrix</a></span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="fl">0.99</span>,<span class="fl">0.01</span>,<span class="fl">0.01</span>,<span class="fl">0.99</span>),<span class="dt">nrow=</span><span class="dv">2</span>,<span class="dt">byrow=</span><span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb22-2" data-line-number="2">simpleMc&lt;-<span class="kw">new</span>(<span class="st">"markovchain"</span>, <span class="dt">states=</span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="st">"a"</span>,<span class="st">"b"</span>),</a>
<a class="sourceLine" id="cb22-3" data-line-number="3">             <span class="dt">transitionMatrix=</span>transMatr)</a>
<a class="sourceLine" id="cb22-4" data-line-number="4"><span class="kw"><a href="../reference/expectedRewards.html">expectedRewards</a></span>(simpleMc,<span class="dv">1</span>,<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="dv">0</span>,<span class="dv">1</span>))</a></code></pre></div>
<pre><code>## [1] 0.01 1.99</code></pre>
<div id="expected-rewards-for-a-set-of-states-in-a-markovchain-process" class="section level2">
<h2 class="hasAnchor">
<a href="#expected-rewards-for-a-set-of-states-in-a-markovchain-process" class="anchor"></a>Expected Rewards for a set of states in a markovchain process</h2>
<p>The package provides a function <code>expectedRewardsBeforeHittingA</code> that returns the value of expected first passage rewards <span class="math inline">\(E\)</span> given rewards coressponding to every state, an initial state. This means the function returns expected reward for given initial state <span class="math inline">\(s_{0}\)</span>, number of transitions <span class="math inline">\(n\)</span> and for a set of states <span class="math inline">\(A\)</span> with a constraint such that the process does not hit any of the states that belong to state <span class="math inline">\(A\)</span>. <span class="math inline">\(S\)</span> is the set of all possible states.</p>
<p>The function uses an equation which is as follows:</p>
<p><span class="math display">\[E = \sum_{i=1}^{n}{1_{s_{0}}P_{S-A}^{i}R_{S-A}}\]</span> here <span class="math inline">\(1_{s_{0}} = [0,0,...0,1,0,...,0,0,0]\)</span>, 1 being on <span class="math inline">\(s_{0}\)</span> position and <span class="math inline">\(R_{S-A}\)</span> being the rewards vector for <span class="math inline">\(S-A\)</span> state.</p>
</div>
</div>
<div id="checking-irreducibility-of-a-ctmc" class="section level1">
<h1 class="hasAnchor">
<a href="#checking-irreducibility-of-a-ctmc" class="anchor"></a>Checking Irreducibility of a CTMC</h1>
<p>The package provides a function <code>is.CTMCirreducible</code> that returns a boolean value stating whether the ctmc object is irreducible. We know that a continuous time markovchain is irreducible if and only if its embedded chain is irreducible<span class="citation">(Sigman 2009)</span>.</p>
<p>We demonstrate an example running the function:</p>
<div class="sourceCode" id="cb24"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb24-1" data-line-number="1">energyStates &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="st">"sigma"</span>, <span class="st">"sigma_star"</span>)</a>
<a class="sourceLine" id="cb24-2" data-line-number="2">byRow &lt;-<span class="st"> </span><span class="ot">TRUE</span></a>
<a class="sourceLine" id="cb24-3" data-line-number="3">gen &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/matrix">matrix</a></span>(<span class="dt">data =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="op">-</span><span class="dv">3</span>, <span class="dv">3</span>,</a>
<a class="sourceLine" id="cb24-4" data-line-number="4">                      <span class="dv">1</span>, <span class="dv">-1</span>), <span class="dt">nrow =</span> <span class="dv">2</span>,</a>
<a class="sourceLine" id="cb24-5" data-line-number="5">             <span class="dt">byrow =</span> byRow, <span class="dt">dimnames =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/list">list</a></span>(energyStates, energyStates))</a>
<a class="sourceLine" id="cb24-6" data-line-number="6">molecularCTMC &lt;-<span class="st"> </span><span class="kw">new</span>(<span class="st">"ctmc"</span>, <span class="dt">states =</span> energyStates, </a>
<a class="sourceLine" id="cb24-7" data-line-number="7">                    <span class="dt">byrow =</span> byRow, <span class="dt">generator =</span> gen, </a>
<a class="sourceLine" id="cb24-8" data-line-number="8">                    <span class="dt">name =</span> <span class="st">"Molecular Transition Model"</span>)</a>
<a class="sourceLine" id="cb24-9" data-line-number="9"><span class="kw"><a href="../reference/is.CTMCirreducible.html">is.CTMCirreducible</a></span>(molecularCTMC)</a></code></pre></div>
<pre><code>## [1] TRUE</code></pre>
</div>
<div id="simulation-of-higher-order-multivariate-markovchains" class="section level1">
<h1 class="hasAnchor">
<a href="#simulation-of-higher-order-multivariate-markovchains" class="anchor"></a>Simulation of Higher Order Multivariate Markovchains</h1>
<p>The package provides <code>predictHommc</code> function. This function provides a simulation system for higher order multivariate markovchains. The function assumes that the state probability distribution of the jth sequence at time <span class="math inline">\(r+1\)</span> depends on the state probability distribution of all the sequences at n previous mon=ments of time i.e. <span class="math inline">\(t = r\)</span> to <span class="math inline">\(t = r-n+1\)</span> . Hence the proposed model takes the form mathematically as:<span class="citation">(Ching, Ng, and Fung 2008)</span></p>
<p><span class="math display">\[
  X_{r+1}^{j} = \sum_{k=1}^{s}\sum_{h=1}^n{\lambda_{jk}^{(h)}P_{h}^{(jk)}X_{r-h+1}^{(k)}}, \ \ \ j =  1,2,....s, \ \ r = n-1,n,...
\]</span> with initals <span class="math inline">\(X_{0}^{(k)},X_{1}^{(k)},......,X_{n-1}^{(k)} \ (k = 1,2,...s)\)</span>. Here,</p>
<p><span class="math inline">\(\lambda_{jk}^{(k)}, \ 1 \leq j,k \leq s, \ 1 \leq h \leq n \ \ \  and \ \ \  \sum_{k=1}^{s}\sum_{h=1}^{n}{\lambda_{jk}^{(h)} = 1}, \ \ \ j = 1,2,....s.\)</span></p>
<p>Now we run an example on sample hommc object for simulating next 3 steps usinf <code>predictHommc</code> function. THe function provides a choice of entering inital states according to the hommc object. In case the user does not enter inital states, the function takes all initial states to be the first state from the set of states.</p>
<div class="sourceCode" id="cb26"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb26-1" data-line-number="1">statesName &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="st">"a"</span>, <span class="st">"b"</span>)</a>
<a class="sourceLine" id="cb26-2" data-line-number="2">P &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/array">array</a></span>(<span class="dv">0</span>, <span class="dt">dim =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="dv">2</span>, <span class="dv">2</span>, <span class="dv">4</span>), <span class="dt">dimnames =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/list">list</a></span>(statesName, statesName))</a>
<a class="sourceLine" id="cb26-3" data-line-number="3">P[,,<span class="dv">1</span>] &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/matrix">matrix</a></span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">1</span><span class="op">/</span><span class="dv">3</span>, <span class="dv">2</span><span class="op">/</span><span class="dv">3</span>), <span class="dt">byrow =</span> <span class="ot">FALSE</span>, <span class="dt">nrow =</span> <span class="dv">2</span>)</a>
<a class="sourceLine" id="cb26-4" data-line-number="4">P[,,<span class="dv">2</span>] &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/matrix">matrix</a></span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="dv">1</span><span class="op">/</span><span class="dv">4</span>, <span class="dv">3</span><span class="op">/</span><span class="dv">4</span>, <span class="dv">0</span>, <span class="dv">1</span>), <span class="dt">byrow =</span> <span class="ot">FALSE</span>, <span class="dt">nrow =</span> <span class="dv">2</span>)</a>
<a class="sourceLine" id="cb26-5" data-line-number="5">P[,,<span class="dv">3</span>] &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/matrix">matrix</a></span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">1</span><span class="op">/</span><span class="dv">3</span>, <span class="dv">2</span><span class="op">/</span><span class="dv">3</span>), <span class="dt">byrow =</span> <span class="ot">FALSE</span>, <span class="dt">nrow =</span> <span class="dv">2</span>)</a>
<a class="sourceLine" id="cb26-6" data-line-number="6">P[,,<span class="dv">4</span>] &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/matrix">matrix</a></span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="dv">3</span><span class="op">/</span><span class="dv">4</span>, <span class="dv">1</span><span class="op">/</span><span class="dv">4</span>, <span class="dv">0</span>, <span class="dv">1</span>), <span class="dt">byrow =</span> <span class="ot">FALSE</span>, <span class="dt">nrow =</span> <span class="dv">2</span>)</a>
<a class="sourceLine" id="cb26-7" data-line-number="7">Lambda &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="fl">0.8</span>, <span class="fl">0.2</span>, <span class="fl">0.3</span>, <span class="fl">0.7</span>)</a>
<a class="sourceLine" id="cb26-8" data-line-number="8">ob &lt;-<span class="st"> </span><span class="kw">new</span>(<span class="st">"hommc"</span>, <span class="dt">order =</span> <span class="dv">1</span>, <span class="dt">states =</span> statesName, <span class="dt">P =</span> P, </a>
<a class="sourceLine" id="cb26-9" data-line-number="9">         <span class="dt">Lambda =</span> Lambda, <span class="dt">byrow =</span> <span class="ot">FALSE</span>, <span class="dt">name =</span> <span class="st">"FOMMC"</span>)</a>
<a class="sourceLine" id="cb26-10" data-line-number="10"></a>
<a class="sourceLine" id="cb26-11" data-line-number="11"><span class="kw"><a href="../reference/predictHommc.html">predictHommc</a></span>(ob,<span class="dv">3</span>)</a></code></pre></div>
<pre><code>##      [,1] [,2] [,3]
## [1,] "b"  "b"  "b" 
## [2,] "b"  "b"  "a"</code></pre>
</div>
<div id="check-time-reversibility-of-continuous-time-markovchains" class="section level1">
<h1 class="hasAnchor">
<a href="#check-time-reversibility-of-continuous-time-markovchains" class="anchor"></a>Check Time Reversibility of Continuous-time markovchains</h1>
<p>A Continuous-time markovchain with generator <span class="math inline">\(Q\)</span> and stationary distribution <span class="math inline">\(\pi\)</span> is said to be time reversible if:<span class="citation">(Dobrow 2016)</span></p>
<p><span class="math display">\[
\pi_{i}q_{ij} = \pi_{j}q_{ji}
\]</span></p>
<p>Intuitively, a continuous-time Markov chain is time reversible if the process in forward time is indistinguishable from the process in reversed time. A consequence is that for all states i and j, the long-term forward transition rate from i to j is equal to the long-term backward rate from j to i.</p>
<p>The package provides <code>is.TimeReversible</code> function to check if a <code>ctmc</code> object is time-reversible. We follow with an example run on a <code>ctmc</code> object.</p>
<div class="sourceCode" id="cb28"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb28-1" data-line-number="1">energyStates &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="st">"sigma"</span>, <span class="st">"sigma_star"</span>)</a>
<a class="sourceLine" id="cb28-2" data-line-number="2">byRow &lt;-<span class="st"> </span><span class="ot">TRUE</span></a>
<a class="sourceLine" id="cb28-3" data-line-number="3">gen &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/matrix">matrix</a></span>(<span class="dt">data =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="op">-</span><span class="dv">3</span>, <span class="dv">3</span>,</a>
<a class="sourceLine" id="cb28-4" data-line-number="4">                        <span class="dv">1</span>, <span class="dv">-1</span>), <span class="dt">nrow =</span> <span class="dv">2</span>,</a>
<a class="sourceLine" id="cb28-5" data-line-number="5">             <span class="dt">byrow =</span> byRow, <span class="dt">dimnames =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/list">list</a></span>(energyStates, energyStates))</a>
<a class="sourceLine" id="cb28-6" data-line-number="6">molecularCTMC &lt;-<span class="st"> </span><span class="kw">new</span>(<span class="st">"ctmc"</span>, <span class="dt">states =</span> energyStates, </a>
<a class="sourceLine" id="cb28-7" data-line-number="7">                    <span class="dt">byrow =</span> byRow, <span class="dt">generator =</span> gen, </a>
<a class="sourceLine" id="cb28-8" data-line-number="8">                    <span class="dt">name =</span> <span class="st">"Molecular Transition Model"</span>)</a>
<a class="sourceLine" id="cb28-9" data-line-number="9"><span class="kw"><a href="../reference/is.TimeReversible.html">is.TimeReversible</a></span>(molecularCTMC)</a></code></pre></div>
<pre><code>## [1] TRUE</code></pre>
</div>
<div id="references" class="section level1">
<h1 class="hasAnchor">
<a href="#references" class="anchor"></a>References</h1>

<div id="refs" class="references">
<div id="ref-freqArticle">
<p>Alexander Kreinin, Marina Sidelnikova. 2001. “Regularization Algorithms for Transition Matrices” 4. ALGO RESEARCH QUARTERLY.</p>
</div>
<div id="ref-ching2008higher">
<p>Ching, Wai-Ki, Michael K Ng, and Eric S Fung. 2008. “Higher-Order Multivariate Markov Chains and Their Applications.” <em>Linear Algebra and Its Applications</em> 428 (2). Elsevier: 492–507.</p>
</div>
<div id="ref-dobrow2016introduction">
<p>Dobrow, Robert P. 2016. <em>Introduction to Stochastic Processes with R</em>. John Wiley &amp; Sons.</p>
</div>
<div id="ref-GallagerBook">
<p>Gallager, Robert G. 2013. <em>Stochastic Processes: Theory for Applications</em>. Cambridge University Press.</p>
</div>
<div id="ref-NorrisBook">
<p>Norris, J. R. 1998. <em>Markovchains</em>. Cambridge University Press.</p>
</div>
<div id="ref-Sigman">
<p>Sigman, Karl. 2009. “Continuous Time Markovchains.” Columbia University.</p>
</div>
<div id="ref-committorlink">
<p>StackOverflow. 2015. <a href="https://math.stackexchange.com/questions/1450399/probability-that-a-chain-will-enter-state-5-before-it-enters-state-3?newreg=82f90b66b949495a91661caad24db915" class="uri">https://math.stackexchange.com/questions/1450399/probability-that-a-chain-will-enter-state-5-before-it-enters-state-3?newreg=82f90b66b949495a91661caad24db915</a>.</p>
</div>
<div id="ref-ictmcpaper">
<p>Thomas Krak, Arno Siebes, Jasper De Bock. 2016. “Imprecise Continuous-Time Markov Chains.” arXiv.</p>
</div>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
        <div id="tocnav">
      <h2 class="hasAnchor">
<a href="#tocnav" class="anchor"></a>Contents</h2>
      <ul class="nav nav-pills nav-stacked">
<li><a href="#expected-hittting-time-using-ctmc">Expected Hittting Time using CTMC</a></li>
      <li><a href="#calculating-probability-at-time-t-using-ctmc">Calculating Probability at time T using ctmc</a></li>
      <li><a href="#plotting-generator-matrix-of-continuous-time-markovchains">Plotting generator matrix of continuous-time markovchains</a></li>
      <li>
<a href="#imprecise-conitnuous-time-markovchains">Imprecise Conitnuous-Time Markovchains</a><ul class="nav nav-pills nav-stacked">
<li><a href="#types-of-ictmcs">Types of ICTMCs</a></li>
      <li><a href="#lower-transition-rate-operators-for-ictmcs">Lower Transition Rate Operators for ICTMCs</a></li>
      <li><a href="#lower-transition-operators">Lower Transition Operators</a></li>
      <li><a href="#impreciseprobabilityatt-function"><code>ImpreciseprobabilityatT</code> function</a></li>
      </ul>
</li>
      <li><a href="#continuous-time-markovchain-generator-using-frequency-matrix">Continuous time markovchain generator using frequency Matrix</a></li>
      <li><a href="#committor-of-a-markovchain">Committor of a markovchain</a></li>
      <li><a href="#first-passage-probability-for-set-of-states">First Passage probability for set of States</a></li>
      <li><a href="#joint-pdf-of-number-of-visits-to-the-various-states-of-a-markovchain">Joint PDF of number of visits to the various states of a markovchain</a></li>
      <li>
<a href="#expected-rewards-for-a-markovchain">Expected Rewards for a markovchain</a><ul class="nav nav-pills nav-stacked">
<li><a href="#expected-rewards-for-a-set-of-states-in-a-markovchain-process">Expected Rewards for a set of states in a markovchain process</a></li>
      </ul>
</li>
      <li><a href="#checking-irreducibility-of-a-ctmc">Checking Irreducibility of a CTMC</a></li>
      <li><a href="#simulation-of-higher-order-multivariate-markovchains">Simulation of Higher Order Multivariate Markovchains</a></li>
      <li><a href="#check-time-reversibility-of-continuous-time-markovchains">Check Time Reversibility of Continuous-time markovchains</a></li>
      <li><a href="#references">References</a></li>
      </ul>
</div>
      </div>

</div>


      <footer><div class="copyright">
  <p>Developed by Giorgio Alfredo Spedicato, Tae Seung Kang, Sai Bhargav Yalamanchi, Deepak Yadav.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.3.0.</p>
</div>
      </footer>
</div>

  

  </body>
</html>
